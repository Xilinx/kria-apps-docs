<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>Hardware Architecture of the Accelerator &mdash; Kria™ KV260 2020.2 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Debugging" href="debug_dd.html" />
    <link rel="prev" title="Hardware Architecture of the Platform" href="hw_arch_platform_dd.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../index.html" class="icon icon-home"> Kria™ KV260
            <img src="../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2020.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Home</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/index.html">SOM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">KV260 Applications</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../smartcamera/smartcamera_landing.html">Smart Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aibox-reid/aibox_landing.html">AIBox-ReID</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../defectdetect_landing.html">Defect Detect</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../defectdetect_landing.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../defectdetect_landing.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../defectdetect_landing.html#tutorials">Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../defectdetect_landing.html#architecture">Architecture</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="sw_arch_platform_dd.html">Software Architecture - Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="sw_arch_accel_dd.html">Software Architecture - Accelerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="hw_arch_platform_dd.html">Hardware Architecture - Platform</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Hardware Architecture - Accelerator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pre-process">Pre-Process</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defect-detection">Defect Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resource-utilization">Resource Utilization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#next-steps">Next Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../defectdetect_landing.html#other">Other</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../nlp-smartvision/nlp_smartvision_landing.html">NLP SmartVision</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Releases</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/main/build/html/index.html">Kria KV260</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Releases</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pages.gitenterprise.xilinx.com/SOM/kv260-docs/2020.2/build/html/index.html">2021.2</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Kria™ KV260</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../defectdetect_landing.html">Defect Detect</a> &raquo;</li>
      <li>Hardware Architecture of the Accelerator</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/docs/defect-detect/docs/hw_arch_accel_dd.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <table class="sphinxhide">
 <tr>
   <td align="center"><img src="../../media/xilinx-logo.png" width="30%"/><h1>Kria&trade; KV260 Vision AI Starter Kit Defect Detection Tutorial</h1>
   </td>
 </tr>
 <tr>
 <td align="center"><h1>Hardware Architecture of the Accelerator</h1> </td>
 </tr>
</table><div class="section" id="hardware-architecture-of-the-accelerator">
<h1>Hardware Architecture of the Accelerator<a class="headerlink" href="#hardware-architecture-of-the-accelerator" title="Permalink to this heading">¶</a></h1>
<p>The Vitis overlay includes the Pre-Process block and the Defect Detection blocks.</p>
<div class="section" id="pre-process">
<h2>Pre-Process<a class="headerlink" href="#pre-process" title="Permalink to this heading">¶</a></h2>
<p>The Pre-Process pipeline reads a video frame from memory, processes it as required for the Defect Detection function, and writes it back to memory. The Pre-Process pipeline is as follows:</p>
<p><img alt="Pre-Process Pipeline Hardware Accelerator" src="../../../_images/pre-process-pipeline-hardware-accel.png" /></p>
<p>This pipeline consists of two Vitis Vision functions whose parameters can be configured via AXI-Lite based register interface.</p>
<ul class="simple">
<li><p>The grey-scale image from the capture pipeline should be converted to a binary image with a specific threshold value. The Threshold function in the Vitis Vision library is used to perform this operation and yields an image that has a black background and a mango area that is white.</p></li>
<li><p>The Median Blur filter acts as a non-linear digital filter that improves noise reduction. A filter size of N would output the median value of the NxN neighborhood pixel values, for each pixel. In this design, N is set to 3.</p></li>
</ul>
<p>An example output image after passing through the Pre-Process pipeline is as follows:</p>
<p><img alt="Pre-Process Pipeline Hardware Accelerator Example" src="../../../_images/pre-process-pipeline-hardware-accel-example.png" /></p>
<blockquote>
<div><p><em><strong>Note</strong></em>: This proprietary image is from <a class="reference external" href="http://www.cofilab.com">COFILAB</a>.</p>
</div></blockquote>
</div>
<div class="section" id="defect-detection">
<h2>Defect Detection<a class="headerlink" href="#defect-detection" title="Permalink to this heading">¶</a></h2>
<p>The block in the Defect Detection pipeline reads a video frame from memory, processes it, and writes it back to memory. The Defect Detection pipeline is as follows:</p>
<p><img alt="Defect Detection Pipeline Hardware Accelerator" src="../../../_images/defect-detection-pipeline-hardware-accel.png" /></p>
<ul class="simple">
<li><p>The Canny edge detector finds the edges in the video frame. In this algorithm, the noise in the image is reduced first by applying a Gaussian mask. The Gaussian mask used here is the average mask of size 3x3. Thereafter, gradients along <em>x</em> and <em>y</em> directions are computed using the Sobel gradient function. The gradients are used to compute the magnitude and phase of the pixels. The phase is quantized, and the pixels are binned accordingly. Non-maximal suppression is applied on the pixels to remove the weaker edges.</p></li>
<li><p>Edge Tracing is applied on the remaining pixels to draw the edges on the image.
The Contour Filling function, which is the final function required to detect defects in the mango, is done in the PS.</p></li>
</ul>
<p>Example output images after Edge Tracing and Contour Filling is done, is as follows:</p>
<p><img alt="Defect Detection Pipeline Hardware Accelerator Example" src="../../../_images/defect-detection-pipeline-hardware-accel-example.png" /></p>
<blockquote>
<div><p><em><strong>Note</strong></em>: This proprietary image is from <a class="reference external" href="http://www.cofilab.com">COFILAB</a>.</p>
</div></blockquote>
</div>
<div class="section" id="resource-utilization">
<h2>Resource Utilization<a class="headerlink" href="#resource-utilization" title="Permalink to this heading">¶</a></h2>
<p>Vitis integrates the pre-processing function and Defect detection function into the platform. The table below shows utilization numbers post implementation.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>K26</th>
<th>CLB LUTs</th>
<th>BRAM</th>
<th>DSP</th>
<th>URAM</th>
</tr>
</thead>
<tbody>
<tr>
<td>Available</td>
<td>117120</td>
<td>144</td>
<td>1248</td>
<td>64</td>
</tr>
<tr>
<td>Platform</td>
<td>22893</td>
<td>18</td>
<td>35</td>
<td>1</td>
</tr>
<tr>
<td>Pre-processing</td>
<td>5244</td>
<td>3.5</td>
<td>9</td>
<td>0</td>
</tr>
<tr>
<td>Canny Edge</td>
<td>6773</td>
<td>8.5</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>Edge Tracing</td>
<td>7114</td>
<td>3</td>
<td>9</td>
<td>5</td>
</tr>
<tr>
<td>Other*</td>
<td>6189</td>
<td>21</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>Total</td>
<td>48181</td>
<td>54</td>
<td>64</td>
<td>7</td>
</tr>
<tr>
<td>Total %</td>
<td>41.14%</td>
<td>37.50%</td>
<td>5.13%</td>
<td>10.94%</td>
</tr>
</tbody>
</table><p>Other* : AXI interconnects and Interrupt concat block added by Vitis
<br /></p>
</div>
<div class="section" id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Go back to the <a class="reference internal" href="../defectdetect_landing.html"><span class="doc">KV260 SOM Defect detect design start page</span></a></p></li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>https://github.com/Xilinx/Vitis_Libraries/tree/master/vision</p></li>
<li><p>https://xilinx.github.io/Vitis_Libraries/vision/2020.2/index.html</p></li>
</ul>
<div class="section" id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this heading">¶</a></h3>
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file except in compliance with the License.</p>
<p>You may obtain a copy of the License at
<a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p align="center">Copyright&copy; 2021 Xilinx</p></div>
</div>
</div>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hw_arch_platform_dd.html" class="btn btn-neutral float-left" title="Hardware Architecture of the Platform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="debug_dd.html" class="btn btn-neutral float-right" title="Debugging" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2022, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">Last updated on August 1, 2022.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="https://pages.gitenterprise.xilinx.com/techdocs/Test/vvas/build/html/index.html#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>