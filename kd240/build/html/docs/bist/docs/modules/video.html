<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
<!-- End Google Tag Manager -->
  <title>BIST Video Test Module &mdash; Kria™ KD240 1.0 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Known Issues" href="../known_issues.html" />
    <link rel="prev" title="BIST Tty Test Module" href="tty.html" /> 
</head>

<body class="wy-body-for-nav">

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
<!-- End Google Tag Manager --> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> Kria™ KD240
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">SOM</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/">Landing Page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/Kria_doc_map/map.htm">Kria Adventure Map</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/creating_applications.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/ubuntu_support.html">Ubuntu Support</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/bootfw.html">Boot Firmware</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/openamp.html">OpenAMP</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/dfx.html">Dynamic Function eXchange</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/ipmi_eeprom.html">IPMI EEPROM Design Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/yocto.html">Yocto Support</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/xen.html">XEN Support</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/kd240-docs.html">Kria KD240</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/kv260-docs.html">Kria KV260</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/kria-apps-docs/kr260-docs.html">Kria KR260</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/KRS/">Kria Robotics Stack</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">KD240 Applications</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../bist_landing.html">BIST</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../run.html">Install and Run BIST</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../overview.html">Overview of BIST Application</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../overview.html#framework">Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../overview.html#file-structure">File Structure</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../overview.html#test-modules">Test Modules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="can.html">CAN Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="disk.html">Disk Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="display.html">Display Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="eeprom.html">EEPROM Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="eth.html">Ethernet Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="gpio.html">GPIO Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="i2c.html">I2C Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="iio.html">IIO Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="motor.html">Motor Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="mtd.html">MTD Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="pwm.html">PWM Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="spi.html">SPI Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="tpm.html">TPM Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="tty.html">TTY Test Module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Video Test Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../overview.html#support">Support</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../known_issues.html">Known Issues</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/Xilinx/kria-bist">Software Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bist_landing.html#support">Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ros2_multinode_communication_via_tsn/ros2_multinode_communication_via_tsn_landing.html">ROS 2 Multi-Node Communications Via TSN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../foc-motor-ctrl/foc_motor_control_landing.html">FOC Motor Control Application</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">KD240 Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../kria_starterkit_linux_boot.html">Booting Kria Starter Kit Linux on KD240</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../building_the_design.html">Building the Design Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../build_vivado_design.html">Building the Hardware Design Using Vivado</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generating_custom_firmware.html">Generate Custom Firmware</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Kria™ KD240</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../bist_landing.html">BIST</a> &raquo;</li>
          <li><a href="../overview.html">BIST Overview</a> &raquo;</li>
      <li>BIST Video Test Module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/bist/docs/modules/video.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="bist-video-test-module">
<h1>BIST Video Test Module<a class="headerlink" href="#bist-video-test-module" title="Permalink to this heading">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>This module tests the video interface(s) on the AMD Kria™ starter kits.</p>
</div>
<div class="section" id="tests">
<h2>Tests<a class="headerlink" href="#tests" title="Permalink to this heading">¶</a></h2>
<p>There are three types of tests in this module:</p>
<ul>
<li><p>Self-validating functional tests</p>
<ul class="simple">
<li><p>imx219_filesink</p></li>
<li><p>ar1335_filesink</p></li>
</ul>
<p>These tests use v4l2-utils to set a test pattern at the sensor and gstreamer
packages to run a Gstreamer pipleine. The set_test_pattern() function sets
the test pattern at the sensor, run_filesink_pipeline() runs the Gstreamer
pipeline, which saves(capture a single frame) the test pattern raw test image.
The compare_images() compares this test image against a pre-defined golden
image and declares pass/fail</p>
</li>
<li><p>Self-validating performance tests:</p>
<ul class="simple">
<li><p>ar1335_ap1302_perf</p></li>
<li><p>tpg_ap1302_perf</p></li>
<li><p>imx219_perf</p></li>
<li><p>ar1335_perf</p></li>
</ul>
<p>These tests use Gstreamer packages to run a gstreamer pipeline on a media
node. The run_perf_pipeline() runs a Gstreamer pipeline and captures the
performance output, within_percentage() checks if the ‘actual_fps’ of the
pipeline is within accepted range of ‘target_fps’.</p>
</li>
<li><p>User-validating functional tests:</p>
<ul class="simple">
<li><p>ar1335_ap1302_ximagesink</p></li>
<li><p>tpg_ap1302_ximagesink</p></li>
</ul>
<p>These tests use v4l2-utils to set a test pattern at the ISP, certain debugfs
commands to set test pattern at the sensor and gstreamer packages to run a
Gstreamer pipeline, which opens up a new window/display(using ximagesink).
run_ximagesink_pipeline() opens up this ximagesink display and waits for User
Input. The user responds with a Y/N if the test pattern was observed.</p>
</li>
</ul>
<p>The config parameters for this test are described below:</p>
<ul class="simple">
<li><p>label: The test label</p></li>
<li><p>pipeline: Name of video pipeline</p></li>
<li><p>width: Width in terms of resolution</p></li>
<li><p>height: Height in terms of resolution</p></li>
<li><p>fps: Targetted frames per second</p></li>
<li><p>fmt: Video format of pipeline</p></li>
<li><p>tpg_pattern: Test pattern generator value(for ximageink and filesink tests)</p></li>
</ul>
<p>Pattern to be observed in ximageink tests:</p>
<p><img alt="Color_Bar_Pattern" src="../../../../_images/Color_Bar_Pattern.png" /></p>
</div>
<div class="section" id="test-execution">
<h2>Test Execution<a class="headerlink" href="#test-execution" title="Permalink to this heading">¶</a></h2>
<p>The example commands for this module are provided below (KV260):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest-3 --board kv260 -m video                       // Run all tests <span class="k">in</span> this module
pytest-3 --board kv260 -k imx219_perf	               // Run imx219_perf <span class="nb">test</span>
pytest-3 --board kv260 -k imx219_filesink             // Run imx219_filesink <span class="nb">test</span>
pytest-3 --board kv260 -k ar1335_ap1302_ximagesink    // Run ar1335_ap1302_ximagesink <span class="nb">test</span>
pytest-3 --board kv260 -k perf -m video               // Run all performance tests <span class="k">in</span> this module
pytest-3 --board kv260 -k filesink -m video           // Run all filesink tests <span class="k">in</span> this module
pytest-3 --board kv260 -k ximagesink -m video         // Run all ximagesink tests <span class="k">in</span> this module
</pre></div>
</div>
<p>For the perf tests, the logs should have a comparison between actual_fps and
target_fps. For a pass, it should be within the accepted percentage range.
Additional debug information with the performance output can be found in the
log file that is generated automatically for each test.
For the filesink tests, expected result is a match between Golden Image and Test
Image. The live log call prints the result of the comparison.
For ximagesink tests, you are asked a question[Y/N] in the live log call, if a
test pattern was seen in the pop-up window. You have 30 seconds to answer it via
command line. Test result is based on your pattern observation.</p>
</div>
<div class="section" id="test-debug">
<h2>Test Debug<a class="headerlink" href="#test-debug" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Make sure that the BIST firmware is loaded.</p></li>
<li><p>If the logs consist of the message, “No media node found” or “Gstreamer command
timed out after 15 seconds. Sensor not connected or faulty,” these would mean
that either the sensor is not connected to the board or the sensor is faulty.
The solution would be to connect the sensor back and power cycle the board and
run the test again. If the sesnor was already connected, try with a new sensor.</p></li>
<li><p>Make sure that you are in an SSH terminal with X11 forwarding enabled, which is
mandatory while running ximagesink tests.</p></li>
</ul>
</div>
<div class="section" id="known-issues-and-limitations">
<h2>Known Issues and Limitations<a class="headerlink" href="#known-issues-and-limitations" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Test pattern at the sensor(ar1335_tpg_ximagesink) does not produce expected
result with a single write to the register. When the pipeline is running, the second
write to register is done. There maybe a delay of around 3 seconds for the test
pattern to be observed.</p></li>
<li><p>The actual_fps in performance tests is currently expected to be within +/- 1
percent relative to the target_fps.</p></li>
</ul>
</div>
<div class="section" id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this heading">¶</a></h2>
<ol class="simple">
<li><p><a class="reference internal" href="../overview.html"><span class="doc">BIST Overview</span></a></p></li>
</ol>
<p class="sphinxhide" align="center"><sub>Copyright © 2023 Advanced Micro Devices, Inc</sub></p><p class="sphinxhide" align="center"><sup><a href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a></sup></p></div>
</div>


           </div>
          </div>
          
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tty.html" class="btn btn-neutral float-left" title="BIST Tty Test Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../known_issues.html" class="btn btn-neutral float-right" title="Known Issues" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, Advanced Micro Devices, Inc.
      <span class="lastupdated">Last updated on January 18, 2024.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>